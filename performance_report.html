<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Website Performance Dashboard</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
        <style>
            :root{
                --bg:#131313;
                --bg-2:#0f1112;
                --card:#1f2224;
                --card-2:#191b1c;
                --muted:#9aa3ac;
                --text:#e6eef6;
                --accent-blue:#2e9bf6;
                --accent-yellow:#ffc94d;
                --glass:rgba(255,255,255,0.02);
            }
            *{box-sizing:border-box}
            html,body{height:100%}
            body{margin:0;padding:36px 40px;background:linear-gradient(180deg,var(--bg-2),#181819);font-family:Inter,system-ui,Arial;color:var(--text)}
            .container{max-width:1150px;margin:0 auto}

            h1{font-size:24px;margin:8px 0 24px 0;font-weight:700;color:#fff}

            .row{display:flex;gap:22px}
            .card{flex:1;background:linear-gradient(180deg,var(--card),var(--card-2));padding:20px;border-radius:12px;box-shadow:0 8px 24px rgba(2,6,23,0.6)}
            .top-metric{display:flex;justify-content:space-between;align-items:center}
            .metric-item{text-align:center;padding:18px;background:transparent;border-radius:8px}
            .metric-value{font-weight:700;font-size:28px}
            .metric-label{font-size:12px;color:var(--muted);margin-top:8px}

            .big-card{margin-top:26px;padding:24px;border-radius:12px;background:linear-gradient(180deg,#131516,#0f1112);box-shadow:0 10px 40px rgba(2,6,23,0.6)}
            .score-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
            .score-label{font-size:13px;color:var(--muted)}
            .score-percent{font-weight:700;color:var(--muted)}
            .progress{height:12px;background:rgba(255,255,255,0.04);border-radius:10px;overflow:hidden;margin-top:8px}
            .progress > i{display:block;height:100%;border-radius:10px}
            .progress .perf{background:var(--accent-blue)}
            .progress .sec{background:var(--accent-yellow)}

            .summary-cards{display:flex;gap:18px;margin-top:22px}
            .list{background:linear-gradient(180deg,var(--card),var(--card-2));padding:18px;border-radius:10px}
            .list .row-item{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.02);color:var(--muted)}
            .list .row-item:last-child{border-bottom:none}

            .small-muted{font-size:12px;color:var(--muted)}

            .action-buttons{
                position:fixed;
                right:20px;
                bottom:20px;
                display:flex;
                gap:12px;
                z-index:100;
            }
            .action-btn{
                background:linear-gradient(180deg,#1f2224,#161718);
                color:var(--text);
                padding:12px 20px;
                border-radius:10px;
                border:1px solid rgba(255,255,255,0.04);
                box-shadow:0 10px 30px rgba(2,6,23,0.6);
                cursor:pointer;
                font-size:14px;
                font-weight:500;
                display:flex;
                align-items:center;
                gap:8px;
                transition:all 0.2s;
            }
            .action-btn:hover{
                transform:translateY(-2px);
                border-color:rgba(255,255,255,0.1);
                background:linear-gradient(180deg,#23272a,#1a1c1e);
            }
            .action-btn svg{
                width:16px;
                height:16px;
                opacity:0.7;
            }
            .action-btn.primary{
                background:linear-gradient(180deg,var(--accent-blue),#2589db);
                border-color:rgba(255,255,255,0.1);
            }
            .action-btn.primary:hover{
                background:linear-gradient(180deg,#3ba4f8,#2b91e3);
            }

            @media(max-width:980px){
                .row,.summary-cards{flex-direction:column}
                .action-buttons{
                    left:20px;
                    right:20px;
                    bottom:20px;
                }
                .action-buttons > *{
                    flex:1;
                    text-align:center;
                    justify-content:center;
                }
            }
        </style>
        {% include '_theme_head.html' %}
    </head>
    <body>
        {% include '_theme_body.html' %}
        <div class="container">
            <h1>Website Performance Dashboard</h1>

            <!-- top two cards -->
            <div class="row">
                <div class="card">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <div style="color:var(--muted);font-size:13px;font-weight:600">PERFORMANCE RESULTS</div>
                        <div style="color:var(--muted);font-size:13px">&nbsp;</div>
                    </div>
                    <div class="top-metric" style="margin-top:18px">
                        <div class="metric-item">
                            <div class="metric-value">{{ result.response_time }}s</div>
                            <div class="metric-label">Load Time</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">{{ result.images }}</div>
                            <div class="metric-label">Images</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">{{ result.scripts }}</div>
                            <div class="metric-label">Scripts</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <div style="color:var(--muted);font-size:13px;font-weight:600">SECURITY RESULTS</div>
                        <div style="color:var(--muted);font-size:13px">&nbsp;</div>
                    </div>
                    <div class="top-metric" style="margin-top:18px">
                        <div class="metric-item">
                            <div class="metric-value">{{ 'Yes' if result.https_used else 'No' }}</div>
                            <div class="metric-label">HTTPS</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">{{ 'Valid' if result.ssl_valid else 'Unknown' }}</div>
                            <div class="metric-label">SSL</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-value">{{ result.present_headers|length }}</div>
                            <div class="metric-label">Headers</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- big scores card -->
            <div class="big-card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <div style="color:var(--muted);font-weight:600">Performance Score</div>
                    <div class="small-muted">{{ result.performance_score }}%</div>
                </div>
                <div class="progress"><i class="perf" style="width:{{ result.performance_score }}%"></i></div>

                <div style="height:16px"></div>

                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <div style="color:var(--muted);font-weight:600">Security Score</div>
                    <div class="small-muted">{{ result.security_score }}%</div>
                </div>
                <div class="progress"><i class="sec" style="width:{{ result.security_score }}%"></i></div>
            </div>

            <!-- resource & security detail cards -->
            <div class="summary-cards">
                <div class="list">
                    <div style="font-weight:600;color:#ccd7e6;margin-bottom:12px">Resource Summary</div>
                    <div class="row-item"><div class="small-muted">Page Size</div><div>{{ result.size_kb }} KB</div></div>
                    <div class="row-item"><div class="small-muted">Total Resources</div><div>{{ result.total_resources or (result.images + result.scripts + result.css_files) }}</div></div>
                    <div class="row-item"><div class="small-muted">CSS Files</div><div>{{ result.css_files }}</div></div>
                </div>

                <div class="list">
                    <div style="font-weight:600;color:#ccd7e6;margin-bottom:12px">Security Details</div>
                    <div class="row-item"><div class="small-muted">SSL Certificate</div><div>{{ result.ssl_status or 'Valid (SHA-256)' }}</div></div>
                    <div class="row-item"><div class="small-muted">HSTS</div><div>{{ 'Enabled' if result.hsts else 'Disabled' }}</div></div>
                    <div class="row-item"><div class="small-muted">CSP</div><div>{{ 'Configured' if result.csp_present else 'Missing' }}</div></div>
                </div>
            </div>

        </div>

        <div class="action-buttons">
            <a href="{{ url_for('recommendations', audit_id=result.id) }}" class="action-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <line x1="10" y1="9" x2="8" y2="9"></line>
                </svg>
                View Recommendations
            </a>
            <form method="POST" action="{{ url_for('report') }}" style="margin:0">
                <input type="hidden" name="audit_id" value="{{ result.id }}">
                <button type="submit" class="action-btn primary">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download Report
                </button>
            </form>
        </div>
    </body>
</html>